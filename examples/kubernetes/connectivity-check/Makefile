# Copyright 2017-2020 Authors of Cilium
# SPDX-License-Identifier: Apache-2.0

OUT := connectivity-check.yaml
OUT_SIMPLE := connectivity-check-simple.yaml
NON_SIMPLE := $(wildcard *multi-node*.yaml)
SRC := $(wildcard *.yaml)
SRC := $(filter-out $(OUT), $(SRC))
SRC_SIMPLE := $(filter-out $(NON_SIMPLE), $(SRC))

all: $(SRC) simple
	@echo '# Automatically generated by Makefile. DO NOT EDIT' > $(OUT)
	for FILE in $(SRC); do \
		cat $$FILE >> $(OUT); \
		echo "---" >> $(OUT); \
	done

simple: $(SRC_SIMPLE)
	@echo '# Automatically generated by Makefile. DO NOT EDIT' > $(OUT_SIMPLE)
	for FILE in $(SRC_SIMPLE); do \
		cat $$FILE >> $(OUT_SIMPLE); \
		echo "---" >> $(OUT_SIMPLE); \
	done
